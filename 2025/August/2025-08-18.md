# Docker Compose: `up --build` Command

## Overview

`docker compose up --build` is used to build (or rebuild) and start Docker containers as defined in your `docker-compose.yml` file. This ensures your containers use the latest code and configuration.

---

## Command Breakdown

| Command                        | Description                                                                 |
|------------------------------- |-----------------------------------------------------------------------------|
| `docker compose up`            | Starts containers using existing images.                                    |
| `docker compose up --build`    | **Rebuilds** images before starting containers (ensures latest changes).    |

---

## When to Use `--build`

### ✅ Use `--build` when:
- You’ve updated your `Dockerfile`.
- You’ve changed your application code and need it reflected in the container.
- You suspect the existing image is outdated or corrupted.

### ❌ Avoid `--build` when:
- No changes have been made to the code or `Dockerfile`.
- You want to save time (rebuilding can be slow).

---

## Example Workflow

### 1. First Run (or after changes):

```bash
docker compose up --build
```
_Builds images and starts containers with the latest changes._

---

### 2. Normal Start (no changes):

```bash
docker compose up
```
_Uses cached images for faster startup._

---

### 3. After Code or Dockerfile Updates:

```bash
docker compose up --build
```
_Ensures containers use the latest code and configuration._

---

## Tips

- Use `--build` sparingly to save time during development.
- To rebuild only a specific service, use:
    ```bash
    docker compose build <service_name>
    docker compose up
    ```
- Check your `docker-compose.yml` and `Dockerfile` for changes before deciding to rebuild.


# n8n Custom Node Development Guide

This guide explains how to create, build, and test a custom n8n node locally.

---

## Table of Contents

1. [Prerequisites](#1-prerequisites)
2. [Node Project Structure](#2-node-project-structure)
3. [Build and Link the Node Locally](#3-build-and-link-the-node-locally)
4. [Install Node in Local n8n Instance](#4-install-node-in-local-n8n-instance)
5. [Start n8n and Test](#5-start-n8n-and-test)
6. [Updating Your Node](#6-updating-your-node)
7. [Troubleshooting](#7-troubleshooting)
8. [References](#8-references)

---

## 1. Prerequisites

- **Node.js** installed (preferably using [nvm](https://github.com/nvm-sh/nvm))
- **n8n** installed globally:
    ```bash
    npm install -g n8n
    ```
- A separate folder for your custom node, e.g.:
    ```
    ~/Desktop/project/n8n-nodes-starter
    ```

---

## 2. Node Project Structure

Your node project should have the following structure:

```
n8n-nodes-starter/
├── credentials/
│   └── EventHub.credentials.ts
├── nodes/
│   └── EventHub.node.ts
├── package.json
├── tsconfig.json
├── gulpfile.js
└── README.md
```

**Example `package.json`:**

```json
{
    "name": "n8n-nodes-eventhub",
    "version": "0.1.0",
    "main": "dist/index.js",
    "scripts": {
        "build": "tsc && gulp build:icons"
    }
}
```

---

## 3. Build and Link the Node Locally

Navigate to your node folder:

```bash
cd ~/Desktop/project/n8n-nodes-starter
```

Build the node:

```bash
npm run build
```
_This compiles TypeScript to `dist/` and builds icons._

Create a global symlink for the node:

```bash
npm link
```

---

## 4. Install Node in Local n8n Instance

Create a custom folder for n8n (if it doesn’t exist):

```bash
mkdir -p ~/.n8n/custom
cd ~/.n8n/custom
npm init -y
```

Link your node into n8n:

```bash
npm link n8n-nodes-eventhub
```

> **Note:** Ensure the name matches the `name` field in your node's `package.json`.

---

## 5. Start n8n and Test

Start n8n:

```bash
n8n start
```

Open n8n in your browser (default: [http://localhost:5678](http://localhost:5678)).

Search for your node by its node class name (e.g., `EventHub`), not the package name.

---

## 6. Updating Your Node

After making changes, rebuild the node:

```bash
cd ~/Desktop/project/n8n-nodes-starter
npm run build
```

Restart n8n:

```bash
n8n start
```

---

## 7. Troubleshooting

| Error | Solution |
|-------|----------|
| `TypeError: require(...).EventHub is not a constructor` | Ensure the class exported from credentials or node matches the import name exactly.<br>Example:<br>```typescript<br>export class EventHub implements INodeType { ... }<br>``` |
| `E404` when linking | Do **not** run `npm link <node>` in the node source folder. Instead, run `npm link` in the source folder and `npm link <node-package-name>` in `~/.n8n/custom`. |

---

## 8. References

- [n8n Custom Node Development Docs](https://docs.n8n.io/integrations/creating-nodes/)
- [Declarative Style Nodes](https://docs.n8n.io/integrations/creating-nodes/declarative/)
